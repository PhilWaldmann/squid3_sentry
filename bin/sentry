#!/usr/bin/env node

var program = require('commander');
var url     = require('url');
var Squid   = require('../lib/squid');

program
  .version('0.0.1')  
  .usage('[options] <path>')
  .option('-r, --redirect <domain>', 'The default domain to redirect if no other is given', 's-team.at')  
  .option('-e, --explain', 'Outputs explainations of the results')
  .parse(process.argv);

Squid.start({
  redirect: program.redirect,
  ldap:{
    url: 'ldap://10.20.30.66:389',
    dn: 'CN=ldap_auth,CN=Users,DC=dabeach,DC=lan',
    password: 'ooDahs0i',
    base: 'DC=dabeach,DC=lan'
  },
  redis:{
    host: '10.20.30.149'
  }
});


Squid.core.addRule({
  name: 'no porn',
  dest_type:'category',
  categories: 'porn',
  redirect: 'no-porn.com',
  allowed: false
});